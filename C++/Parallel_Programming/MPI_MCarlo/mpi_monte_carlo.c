/* Project:    mpi_monte_carlo File:       mpi_monte_carlo.cpp Created By: James Williams Date:       11/14/15. Purpose:    Estimate Pi by simulation of throwing darts at a dart board.             Program will use MPI for distributed computing across nodes.             1. Process 0 should read in the total number of tosses and             broadcast it to the other processes.             2. Use MPI Reduce to find the global sum of the local variable number             in circle, and have process 0 print the result. Compile:    mpicc mpi_monte_carlo.c -o MPI_MCarlo Usage:      mpiexec -n <# nodes or processors> MPI_MCarlo*//* prototype */double calc_pi(long long, long long);/* prototype *//* include */#include <stdio.h>#include <stdlib.h>#include <mpi.h>/* include */int main(int argc, char * argv[]) {    long long local_darts, local_hits, total_hits, num_darts = 16000000;    double pi, x, y;    int my_rank, num_nodes, i;    MPI_Init(&argc, &argv);    MPI_Comm_size(MPI_COMM_WORLD, &num_nodes);    MPI_Comm_rank(MPI_COMM_WORLD, &my_rank);    local_darts = num_darts/num_nodes;    if(my_rank == 0){        local_darts = (num_darts-(num_nodes-1)*local_darts);    }    unsigned int seed;    seed = time(NULL)+my_rank;    total_hits =0; local_hits = 0;    srand(my_rank);    for (i = 0;i < local_darts; i++){        x = ((double) rand_r(&seed)/RAND_MAX*(1.0 - 0.0) + 0.0);                /*******************************************         * do not need to worry about race conditions         */                 y = ((double) rand_r(&seed+num_nodes)/RAND_MAX*(1.0 - 0.0) + 0.0);        if((x*x) + (y*y) <=1) {            ++local_hits;        }    }    //   int MPI_Reduce(    //   void *sendbuf [in] address of send buffer (choice),    //   void *recvbuf [out] address of receive buffer (choice, significant only at root),    //   int count [in] number of elements in send buffer (integer),    //   MPI_Datatype datatype [in] data type of elements of send buffer (handle),    //   MPI_Op op [in] reduce operation (handle),    //   int root [in] rank of root process (integer),    //   MPI_Comm comm [in] communicator (handle)    // );    MPI_Reduce(&local_hits,      &total_hits, 1,      MPI_DOUBLE, MPI_SUM,            /***********************************       * long long - not double       */      0, MPI_COMM_WORLD);    if(my_rank == 0){      pi = calc_pi(num_darts, total_hits);      printf("Evaluation of Pi: darts = %lld\t", num_darts);      printf("Hits = %lld\t", total_hits);      printf("Pi = %f\n", pi);    }    MPI_Finalize();    return 0;}double calc_pi(long long n, long long m){    double my_pi =  (4 * (double)m / (double)n);    return my_pi;} /* calc_pi *//*********************************************** * 46/50 Please see my comments in your code. */